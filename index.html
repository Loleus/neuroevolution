<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <title>Neuroewolucja</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description"
        content="Algorytm genetyczny optymalizuje wagi sieci neuronowej, która steruje agentem poruszającym się w labiryncie. Celem jest dotarcie do wyjścia w jak najmniejszej liczbie kroków.">
    <!-- Facebook Meta Tags -->
    <meta property="og:url" content="https://loleus.github.io/neuroevolution/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Neuroewolucja">
    <meta property="og:description"
        content="Algorytm genetyczny optymalizuje wagi sieci neuronowej, która steruje agentem poruszającym się w labiryncie. Celem jest dotarcie do wyjścia w jak najmniejszej liczbie kroków.">
    <meta property="og:image" content="https://loleus.github.io/neuroevolution/ogpic.jpg">
    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:domain" content="loleus.github.io">
    <meta property="twitter:url" content="https://loleus.github.io/neuroevolution/">
    <meta name="twitter:title" content="Neuroewolucja">
    <meta name="twitter:description"
        content="Algorytm genetyczny optymalizuje wagi sieci neuronowej, która steruje agentem poruszającym się w labiryncie. Celem jest dotarcie do wyjścia w jak najmniejszej liczbie kroków.">
    <meta name="twitter:image" content="https://loleus.github.io/neuroevolution/ogpic.jpg">

    <link rel="stylesheet" href="./style.css">
</head>

<body>
    <div id="controls">

        <h3>Neuroewolucja</h3>
        <canvas id="hist" width="280" height="96"></canvas>
        <div class="hist">

            <span class="pill">Populacja<br><b id="pop"></b></span>
            <span class="pill">Generacja<br><b id="gen">0</b></span>
            <span class="pill">Naj./Śr.fit<br><b id="best">0.000</b> / <b id="avg">0.000</b></span>
        </div>
        <div class="params">
            <div class="param-line"
                style="border: 1px solid #00ca18; padding: 0 10px 3px;border-radius: 5px;margin-bottom: 5px;">
                <label><b>Neurony</b></label>
                <span><b id="hiddenVal">8</b></span>
            </div>
            <input id="hidden" type="range" min="2" max="64" value="8">

            <div class="param-line">
                <label><b>Prędkość</b></label>
                <span><b id="speedVal">10.0</b></span>
            </div>
            <input id="speed" type="range" min="5" max="20" value="10">

            <div class="param-line">
                <label><b>Mutacja</b></label>
                <span><b id="mutRateVal">10%</b></span>
            </div>
            <input id="mutRate" type="range" min="1" max="50" value="10">

            <div class="param-line">
                <label><b>Elita</b></label>
                <span><b id="eliteVal">3</b></span>
            </div>
            <input id="elite" type="range" min="0" max="7" value="3">


            <div class="param-line">
                <label><b>Rozmiar turnieju</b></label>
                <span><b id="tourSizeVal">20</b></span>
            </div>
            <input id="tourSize" type="range" min="5" max="50" value="20">

            <label>
                <input id="tourNoRepeat" type="checkbox" />
                Bez powtórzeń
            </label>

        </div>
        <div class="buttons">
            <button id="restart">Restart</button>
            <button id="pause">Pauza</button>
        </div>
    </div>

    <div id="left">
        <canvas id="cv" width="320" height="320"></canvas>
        <p class="desc">
            <b>Neurony</b> – liczba neuronów w warstwie ukrytej sieci<br>
            <b>Mutacja</b> – prawdopodobieństwo mutacji pojedynczej wagi<br>
            <b>Elitaryzm</b> – ile najlepszych agentów przechodzi bez zmian do następnej generacji<br>
            <b>Rozmiar turnieju</b> – liczba uczestników w każdym turnieju selekcji<br>
            <b>Bez powtórzeń</b> – checkbox zapobiegający wielokrotnemu udziałowi tego samego agenta w turnieju<br>
        </p>
    </div>
    <div class="right desc">
        <h3>Sieć Neuronowa (Fenotyp)</h3>
        <p>W projekcie używana jest prosta, w pełni połączona sieć feed‑forward:<br>
            
            - **Architektura:** `6 → HIDDEN → 2`  
              - 6 wejść: 4 odległości do ścian (promienie) + znormalizowany wektor w kierunku celu (gx, gy)  
              - `HIDDEN` (domyślnie 8) neuronów warstwy ukrytej  
              - 2 wyjścia: wektor ruchu `(dx, dy)` agenta
            - **Aktywacje:**
              - warstwa ukryta: ReLU
              - wyjście: `tanh` (ruch ograniczony do [-1, 1])
            - **Uczenie:** brak gradientów, wyłącznie neuroewolucja (mutacje + krzyżowanie) na wagach `W1, b1, W2, b2`.  
            - **Inicjalizacja:** losowa z normalnego rozkładu (He‑podobna (`sqrt(2/n)`) – kluczowe, by uniknąć zanikających gradientów (gdybyśmy używali BP) i martwych neuronów.), skalowana względem rozmiarów warstw.
            
            To jest minimalny, jednowarstwowy MLP bez pamięci (brak RNN/LSTM, brak konwolucji)
        </p>

        <h3>Algorytm Genetyczny (Optymalizator)</h3>
        <p>
            1. **Kodowanie osobnika:** wszystkie wagi i biasy sieci (`W1, b1, W2, b2`).
            2. **Ocena (fitness):**
               - głównie: postęp w kierunku celu (najlepsza i bieżąca minimalna odległość),
               - bonusy: dotarcie do celu, szybkie dojście, przeżycie, mało kolizji, bliskość celu na końcu,
               - fitness obcięty do ~10.
            3. **Selekcja:**
               - sortowanie populacji wg fitness,
               - **elita:** `ELITE_COUNT` najlepszych przechodzi wprost do następnej generacji (z opcjonalną bardzo małą mutacją przy wysokim fitness bez osiągnięcia celu),
               - reszta: **turniej** (Tournament Selection) z parametrami `TOUR_SIZE`, `TOUR_NO_REPEAT`.
            4. **Krzyżowanie (crossover):**
               - proste jednogenowe mieszanie: dla każdej wagi/biasu dziecko dostaje wartość od losowo wybranego rodzica (prawdopodobieństwo 0.5).
            5. **Mutacja:**
               - prawdopodobieństwo mutacji pojedynczej wagi: `MUT_RATE`,
               - siła mutacji zależna od:
                 - numeru generacji (maleje z czasem, ale nie do zera),
                 - średniej wartości wag i biasów w warstwach (normalizacja),
                 - współczynnika „stagnacji” (większa mutacja, gdy fitness utknie nisko).
            6. **Dodatki:**
               - statystyki generacji (średni/max fitness, σ, histogram),
               - heurystyki ruchu i system „ostrzeżeń” przy kolizjach, ale to logika środowiska, nie GA.
            
            To jest klasyczny GA + tournament, bez selekcji ruletkowej, bez CMA‑ES, bez NEAT (brak ewolucji topologii).
        </p>
        <div class="history">
          <h3>Co to?</h3>
          <p class="desc">
            Algorytm genetyczny optymalizuje wagi sieci neuronowej, która steruje agentem
            poruszającym się w labiryncie. Celem jest dotarcie do wyjścia w jak najmniejszej liczbie kroków.
        </p>
        </div>
      </div>
    <script src="./index.js"></script>
</body>

</html>