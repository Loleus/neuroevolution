<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <title>Neuroewolucja</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description"
        content="Algorytm genetyczny optymalizuje wagi sieci neuronowej, która steruje agentem poruszającym się w labiryncie. Celem jest dotarcie do wyjścia w jak najmniejszej liczbie kroków.">
    <!-- Facebook Meta Tags -->
    <meta property="og:url" content="https://loleus.github.io/neuroevolution/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Neuroewolucja">
    <meta property="og:description"
        content="Algorytm genetyczny optymalizuje wagi sieci neuronowej, która steruje agentem poruszającym się w labiryncie. Celem jest dotarcie do wyjścia w jak najmniejszej liczbie kroków.">
    <meta property="og:image" content="https://loleus.github.io/neuroevolution/ogpic.jpg?v=2">
    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:domain" content="loleus.github.io">
    <meta property="twitter:url" content="https://loleus.github.io/neuroevolution/">
    <meta name="twitter:title" content="Neuroewolucja">
    <meta name="twitter:description"
        content="Algorytm genetyczny optymalizuje wagi sieci neuronowej, która steruje agentem poruszającym się w labiryncie. Celem jest dotarcie do wyjścia w jak najmniejszej liczbie kroków.">
    <meta name="twitter:image" content="https://loleus.github.io/neuroevolution/ogpic.jpg?v=2">

    <link rel="stylesheet" href="./style.css">
</head>

<body>
    <div id="controls">

        <h3>Neuroewolucja</h3>
        <canvas id="hist" width="280" height="96"></canvas>
        <div class="hist">

            <span class="pill">Populacja<br><b id="pop"></b></span>
            <span class="pill">Generacja<br><b id="gen">0</b></span>
            <span class="pill">Naj./Śr.fit<br><b id="best">0.000</b> / <b id="avg">0.000</b></span>
        </div>
        <div class="params">
            <div class="param-line">
                <label><b>Neurony</b></label>
                <span><b id="hiddenVal">8</b></span>
            </div>
            <input id="hidden" type="range" min="2" max="64" value="8">

            <div class="param-line">
                <label><b>Prędkość</b></label>
                <span><b id="speedVal">10.0</b></span>
            </div>
            <input id="speed" type="range" min="5" max="20" value="10">

            <div class="param-line">
                <label><b>Mutacja</b></label>
                <span><b id="mutRateVal">10%</b></span>
            </div>
            <input id="mutRate" type="range" min="1" max="50" value="10">

            <div class="param-line">
                <label><b>Elita</b></label>
                <span><b id="eliteVal">3</b></span>
            </div>
            <input id="elite" type="range" min="0" max="7" value="3">


            <div class="param-line">
                <label><b>Rozmiar turnieju</b></label>
                <span><b id="tourSizeVal">20</b></span>
            </div>
            <input id="tourSize" type="range" min="5" max="50" value="20">

            <label>
                <input id="tourNoRepeat" type="checkbox" />
                Bez powtórzeń
            </label>

        </div>
        <div class="buttons">
            <button id="restart">Restart</button>
            <button id="pause">Pauza</button>
        </div>
    </div>

    <div id="left">
        <canvas id="cv" width="320" height="320"></canvas>
        <div class="history">
            <h3>Co to?</h3>
            Algorytm genetyczny optymalizuje wagi sieci neuronowej, która steruje agentem
            poruszającym się w labiryncie. Celem jest dotarcie do wyjścia w jak najmniejszej liczbie kroków.
        </div>
        <div class="info">
            <ul>
                <li><b>Neurony</b> – liczba neuronów w warstwie ukrytej sieci<br></li>
                <li><b>Mutacja</b> – prawdopodobieństwo mutacji pojedynczej wagi<br></li>
                <li><b>Elitaryzm</b> – ile najlepszych agentów przechodzi bez zmian do następnej generacji<br></li>
                <li><b>Rozmiar turnieju</b> – liczba uczestników w każdym turnieju selekcji<br></li>
                <li><b>Bez powtórzeń</b> – checkbox zapobiegający wielokrotnemu udziałowi tego samego agenta w
                    turnieju<br></li>
            </ul>
        </div>
    </div>
    <div class="right desc">
        <h3>Sieć Neuronowa (Fenotyp)</h3>
        <p>W projekcie używana jest sieć <a target="_blank"
                href="https://pl.wikipedia.org/wiki/Jednokierunkowa_sie%C4%87_neuronowa">feed‑forward.</a>
            Minimalny, jednowarstwowy <a target="_blank"
                href="https://pl.wikipedia.org/wiki/Perceptron_wielowarstwowy">MLP</a> bez
            pamięci (brak <a href="https://pl.wikipedia.org/wiki/D%C5%82uga_pami%C4%99%C4%87_kr%C3%B3tkotrwa%C5%82a"
                target="_blank">RNN/LSTM</a>, brak konwolucji)<br>
        <ul>
            <li>
                <b>Architektura: (6 → HIDDEN → 2)</b> - 6 wejść: 4 kierunki + znormalizowany wektor w kierunku celu (gx,
                gy) → `HIDDEN` (domyślnie 8) neuronów warstwy ukryte (max 64) → 2 wyjścia: wektor ruchu `(dx, dy)`
                agenta<br>
            </li>
            <li>
                <b>Aktywacje:</b> warstwa ukryta: <a href="https://pl.wikipedia.org/wiki/ReLU" target="_blank">ReLU</a>,
                wyjście: <a href="https://pl.wikipedia.org/wiki/Funkcje_hiperboliczne" target="_blank">tanh(x)</a> - ruch
                ograniczony do [-1, 1] <br>
            </li>
            <li>
                <b>Uczenie:</b> brak gradientów, wyłącznie neuroewolucja (mutacje + krzyżowanie).<br>
            </li>
            <li>
                <b>Inicjalizacja:</b> losowa z normalnego rozkładu (<a
                    href="https://en.wikipedia.org/wiki/Weight_initialization" target="_blank">He‑podobna</a>).
                Klasyczna He jest pod <a href="https://pl.wikipedia.org/wiki/Propagacja_wsteczna"
                    target="_blank">BP</a>: gradient ma sensowną skalę. Projekt używa He z mianownikiem fan-in + fan-out
                (w stylu Xavier/Glorot), co działa jak dodatkowe „uśrednienie” skali w obu kierunkach przepływu sygnału,
                aby uniknąć zanikających gradientów (jak przy BP) i martwych neuronów. Skalowana względem rozmiarów
                warstw.<br>
            </li>
        </ul>

        </p>

        <h3>Algorytm Genetyczny (Optymalizator)</h3>
        <ul>
            <li>
                <b>Kodowanie osobnika:</b> wszystkie wagi i biasy sieci (`W1, b1, W2, b2`)<br>
            </li>

            <li>
                <b>Ocena (fitness):</b> dotarcie do celu (+10.0 + bonus za szybkość), postęp w kierunku celu (nagroda za
                zmniejszenie odległości - najlepsza trasa i aktualna). Bonusy: za przeżycie (+0.3 jeśli agent żyje), za
                eksplorację (zachęta do ruchu w późniejszych krokach), za unikanie kolizji (zmniejsza się z każdym
                ostrzeżeniem), za bliskość celu w końcowej fazie (zachęta do "dokończenia” zadania)<br>
            </li>
            <li>
                <b>Selekcja:</b> sortowanie populacji wg fitness, elita (ilu najlepszych agentów przechodzi wprost do
                następnej generacji - z opcjonalną bardzo małą
                mutacją przy wysokim fitness bez osiągnięcia celu), reszta - turniej (Tournament Selection).<br>
            </li>

            <li>
                <b>Krzyżowanie (crossover):</b> proste jednogenowe mieszanie: dla każdej wagi/biasu dziecko dostaje
                wartość od losowo wybranego rodzica (prawdopodobieństwo 0.5).<br>
            </li>
            <li>
                <b>Mutacja:</b> adaptacyjna <a href="https://pl.wikipedia.org/wiki/Rozk%C5%82ad_normalny"
                    target="_blank">Gaussa.</a>
                Siła mutacji skaluje się do średniej wartości wag w warstwie. Zapobiega "eksplozji" wag i pozwala na
                precyzyjne dostrojenie. Zależna od współczynnika „stagnacji” (większa mutacja, gdy fitness
                utknie nisko), oraz od numeru generacji (maleje z czasem, ale nie do zera)<br>
            </li>
            <li><a href="https://pl.wikipedia.org/wiki/Algorytm_genetyczny" target="_blank"><b>Klasyczny GA</b></a> + tournament</b>, bez <a href="https://en.wikipedia.org/wiki/CMA-ES" target="_blank">CMA‑ES</a>, bez <a href="https://en.wikipedia.org/wiki/Neuroevolution_of_augmenting_topologies" target="_blank">NEAT</a> (brak ewolucji topologii).<br>
            </li>
            <li><b>Dodatki:</b> statystyki generacji (średni/max fitness, <a
                    href="https://pl.wikipedia.org/wiki/Odchylenie_standardowe">odchylenie standardowe - σ</a>,
                histogram), heurystyki ruchu i system „ostrzeżeń” przy kolizjach.<br>
            </li>
        </ul>

    </div>
    <script src="./index.js"></script>
</body>

</html>